---
import MainLayout from '../layouts/MainLayout.astro';
import { getAllTeams, getTeamBadge } from '../utils/dataProcessor.js';

// Get all teams from markdown files
const teams = getAllTeams();
---

<MainLayout title="Premier League Teams - The Football Family">
    <!-- Header Section -->
    <section class="py-16 px-4 bg-gradient-to-br from-blue-50 to-indigo-100">
        <div class="container mx-auto text-center">
            <h1 class="text-4xl md:text-6xl font-bold text-gray-900 mb-6">
                Premier League Teams
            </h1>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                Explore detailed information about all 20 Premier League clubs, including their history, stadiums, and current statistics.
            </p>
        </div>
    </section>

    <!-- Search and Filter -->
    <section class="px-4 mb-8">
        <div class="container mx-auto">
            <div class="max-w-md mx-auto">
                <input 
                    type="text" 
                    id="team-search" 
                    placeholder="Search teams..." 
                    class="w-full px-4 py-3 rounded-lg border border-gray-300 text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm"
                />
            </div>
        </div>
    </section>

    <!-- Teams Grid -->
    <section class="px-4 pb-16">
        <div class="container mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="teams-grid">
                {teams.map((team: any) => {
                    const badge = getTeamBadge(team.slug);
                    return (
                        <div class="team-card bg-white rounded-xl p-6 hover:shadow-lg transition-all duration-300 border border-gray-200 shadow-sm hover:scale-105">
                            <div class="flex items-center mb-4">
                                <div class="w-12 h-12 rounded-lg flex items-center justify-center mr-4 bg-gray-100 border border-gray-200">
                                    {badge ? (
                                        badge.type === 'svg' || badge.type === 'image' ? (
                                            <img 
                                                src={badge.path} 
                                                alt={`${team.title || team.name} badge`}
                                                class="w-8 h-8 object-contain"
                                            />
                                        ) : badge.type === 'combined-svg' ? (
                                            <svg 
                                                viewBox={badge.viewBox}
                                                class="w-8 h-8 object-contain"
                                                style={`clip-path: ${badge.clipPath}`}
                                            >
                                                <use href={`${badge.svgPath}#${team.slug.replace('-', '_')}`} />
                                            </svg>
                                        ) : (
                                            <div class="w-8 h-8 bg-blue-600 rounded text-white text-xs font-bold flex items-center justify-center">
                                                {team.title?.charAt(0) || team.name?.charAt(0) || 'T'}
                                            </div>
                                        )
                                    ) : (
                                        <div class="w-8 h-8 bg-blue-600 rounded text-white text-xs font-bold flex items-center justify-center">
                                            {team.title?.charAt(0) || team.name?.charAt(0) || 'T'}
                                        </div>
                                    )}
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-900">{team.title || team.name}</h3>
                                    <p class="text-gray-500 text-sm">Est. {team.founded}</p>
                                </div>
                            </div>
                            
                            <div class="space-y-2 mb-4">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-500">Stadium:</span>
                                    <span class="text-gray-900 font-medium">{team.stadium}</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-500">Capacity:</span>
                                    <span class="text-gray-900 font-medium">{team.capacity?.toLocaleString()}</span>
                                </div>
                            </div>
                            
                            {team.colors && (
                                <div class="flex space-x-2 mb-4">
                                    {Object.values(team.colors).map((color: any) => (
                                        <div class="w-6 h-6 rounded-full border-2 border-gray-200" style={`background-color: ${color}`}></div>
                                    ))}
                                </div>
                            )}
                            
                            <a href={`/teams/${team.slug}`} class="block w-full bg-blue-600 hover:bg-blue-700 text-white text-center py-2 rounded-lg font-medium transition-colors">
                                View Details
                            </a>
                        </div>
                    );
                })}
            </div>
        </div>
    </section>

    <!-- Quick Stats -->
    <section class="py-16 px-4 bg-black/20">
        <div class="container mx-auto">
            <h2 class="text-3xl font-bold text-center text-white mb-12">League Overview</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8 text-center">
                <div>
                    <div class="text-3xl font-bold text-white mb-2">{teams.length}</div>
                    <div class="text-green-200">Teams</div>
                </div>
                <div>
                    <div class="text-3xl font-bold text-white mb-2">38</div>
                    <div class="text-green-200">Games per Team</div>
                </div>
                <div>
                    <div class="text-3xl font-bold text-white mb-2">380</div>
                    <div class="text-green-200">Total Matches</div>
                </div>
                <div>
                    <div class="text-3xl font-bold text-white mb-2">1992</div>
                    <div class="text-green-200">Founded</div>
                </div>
            </div>
        </div>
    </section>
</MainLayout>

<script>
    // Team search functionality
    const searchInput = document.getElementById('team-search') as HTMLInputElement;
    const teamsGrid = document.getElementById('teams-grid');
    const teamCards = document.querySelectorAll('.team-card');

    searchInput?.addEventListener('input', (e) => {
        const searchTerm = (e.target as HTMLInputElement)?.value?.toLowerCase() || '';
        
        teamCards.forEach(card => {
            const teamName = card.querySelector('h3')?.textContent?.toLowerCase() || '';
            const stadium = card.querySelector('.text-white')?.textContent?.toLowerCase() || '';
            
            if (teamName.includes(searchTerm) || stadium.includes(searchTerm)) {
                (card as HTMLElement).style.display = 'block';
            } else {
                (card as HTMLElement).style.display = 'none';
            }
        });
    });
</script>